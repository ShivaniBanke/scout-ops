apiVersion: grizzly.grafana.com/v1alpha1
kind: AlertRuleGroup
metadata:
    name: eesmjo9rimnswf.Per Minute Eval
spec:
    folderUid: eesmjo9rimnswf
    interval: 60
    rules:
        - annotations:
            __dashboardUid__: dermo1ksrv6yob
            __panelId__: "5"
            description: "Free Disk below 100 GB on base1 {{ $labels.Host}} \n\ncurrent value {{ index $values \"B\" }}"
            summary: Free Disk below 10 GB on base1-clickhouse {{ $labels.Host}}
          condition: C
          data:
            - datasourceUid: ds-scout-altinity-ch
              model:
                adHocFilters: []
                adHocValuesQuery: ""
                add_metadata: true
                contextWindowSize: "10"
                database: base14
                datasource:
                    type: vertamedia-clickhouse-datasource
                    uid: ds-scout-altinity-ch
                dateTimeColDataType: TimeUnix
                dateTimeType: DATETIME64
                editorMode: sql
                extrapolate: true
                format: time_series
                formattedQuery: SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t
                interval: ""
                intervalFactor: 1
                intervalMs: 1000
                maxDataPoints: 43200
                nullifySparse: false
                query: |+
                    select $timeSeries t, Attributes['hostname'] as Host,  max(Value) as DiskFreeBytes from $table
                    where $timeFilter
                    AND ServiceName = 'base1-clickhouse'
                    AND MetricName = 'chi_clickhouse_metric_DiskFreeBytes'
                    group by t, Host

                rawQuery: |-
                    /* grafana dashboard=$__dashboard, user='4' */
                    select (intDiv(toFloat64(TimeUnix) * 1000, (5 * 1000)) * (5 * 1000)) t, Attributes['hostname'] as Host,  max(Value) as DiskFreeBytes from base14.otel_metrics_gauge
                    where TimeUnix >= toDateTime64(1753118493,3) AND TimeUnix <= toDateTime64(1753122093,3)
                    AND ServiceName = 'base1-clickhouse'
                    AND MetricName = 'chi_clickhouse_metric_DiskFreeBytes'
                    group by t, Host
                refId: A
                round: 0s
                skip_comments: true
                table: otel_metrics_gauge
                useWindowFuncForMacros: true
              refId: A
              relativeTimeRange:
                from: 600
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: A
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: B
                settings:
                    mode: ""
                type: reduce
              refId: B
              relativeTimeRange: {}
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 1e+11
                        type: lt
                      operator:
                        type: and
                      query:
                        params:
                            - C
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: B
                intervalMs: 1000
                maxDataPoints: 43200
                refId: C
                type: threshold
              refId: C
              relativeTimeRange: {}
          execErrState: Error
          folderUID: eesmjo9rimnswf
          for: 1m0s
          id: 1
          noDataState: NoData
          notification_settings:
            group_by: null
            mute_time_intervals: null
            receiver: base14-oncall
          orgID: 1
          ruleGroup: Per Minute Eval
          title: Free Disk below 10 GB on base1-clickhouse
          uid: desmjrbjuyvwgf
          updated: "2025-08-03T16:34:42.000Z"
        - annotations:
            __dashboardUid__: dermo1ksrv6yob
            __panelId__: "5"
            description: "Free Disk below 100 GB on aps1-clickhouse Node {{ $labels.Host}} \n\n{{ index $values \"B\" }}  - Used Disk for {{ index $labels.Host }} over the last 5 minutes."
            summary: Free Disk below 100 GB on aps1-clickhouse Node {{ $labels.Host }}
          condition: C
          data:
            - datasourceUid: ds-scout-altinity-ch
              model:
                adHocFilters: []
                adHocValuesQuery: ""
                add_metadata: true
                contextWindowSize: "10"
                database: base14
                datasource:
                    type: vertamedia-clickhouse-datasource
                    uid: ds-scout-altinity-ch
                dateTimeColDataType: TimeUnix
                dateTimeType: DATETIME64
                editorMode: sql
                extrapolate: true
                format: time_series
                formattedQuery: SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t
                interval: ""
                intervalFactor: 1
                intervalMs: 1000
                maxDataPoints: 43200
                nullifySparse: false
                query: "-- $columns(Attributes['hostname'] Host,  max(Value) DiskFreeBytes) from $table \nselect $timeSeries t, Attributes['hostname'] as Host,  max(Value) as DiskFreeBytes from $table\nwhere $timeFilter\nAND ServiceName = 'aps1-clickhouse'\nAND MetricName = 'chi_clickhouse_metric_DiskFreeBytes'\nAND Attributes['hostname'] in ('chi-clickhouse-ch-01-0-0.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-1.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-2.clickhouse.svc.cluster.local')\ngroup by t, Host\norder by t, Host\n"
                rawQuery: |-
                    /* grafana dashboard=$__dashboard, user='4' */

                    select (intDiv(toFloat64(TimeUnix) * 1000, (60 * 1000)) * (60 * 1000)) t, Attributes['hostname'] as Host,  max(Value) as DiskFreeBytes from base14.otel_metrics_gauge
                    where TimeUnix >= toDateTime64(1754152056,3) AND TimeUnix <= toDateTime64(1754238456,3)
                    AND ServiceName = 'aps1-clickhouse'
                    AND MetricName = 'chi_clickhouse_metric_DiskFreeBytes'
                    AND Attributes['hostname'] in ('chi-clickhouse-ch-01-0-0.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-1.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-2.clickhouse.svc.cluster.local')
                    group by t, Host
                    order by t, Host
                refId: A
                round: 0s
                skip_comments: true
                table: otel_metrics_gauge
                useWindowFuncForMacros: true
              refId: A
              relativeTimeRange:
                from: 300
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: A
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: B
                type: reduce
              refId: B
              relativeTimeRange: {}
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 1.073741824e+11
                        type: lt
                      operator:
                        type: and
                      query:
                        params:
                            - C
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: B
                intervalMs: 1000
                maxDataPoints: 43200
                refId: C
                type: threshold
              refId: C
              relativeTimeRange: {}
          execErrState: Error
          folderUID: eesmjo9rimnswf
          for: 1m0s
          id: 2
          noDataState: NoData
          notification_settings:
            group_by: null
            mute_time_intervals: null
            receiver: base14-oncall
          orgID: 1
          ruleGroup: Per Minute Eval
          title: Free Disk below 100 GB on aps1-clickhouse
          uid: aesx2xauv4iyod
          updated: "2025-08-03T16:34:42.000Z"
        - annotations:
            __dashboardUid__: dermo1ksrv6yob
            __panelId__: "5"
            description: "Free Disk below 100 GB on as1-clickhouse Node {{ $labels.Host }} \n\n{{ index $values \"B\" }}  - Used Disk for {{ index $labels.Host }} over the last 5 minutes."
            summary: Free Disk below 100 GB on as1-clickhouse host  {{ $labels.Host }}
          condition: C
          data:
            - datasourceUid: ds-scout-altinity-ch
              model:
                adHocFilters: []
                adHocValuesQuery: ""
                add_metadata: true
                contextWindowSize: "10"
                database: base14
                datasource:
                    type: vertamedia-clickhouse-datasource
                    uid: ds-scout-altinity-ch
                dateTimeColDataType: TimeUnix
                dateTimeType: DATETIME64
                editorMode: sql
                extrapolate: true
                format: time_series
                formattedQuery: SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t
                interval: ""
                intervalFactor: 1
                intervalMs: 1000
                maxDataPoints: 43200
                nullifySparse: false
                query: |+
                    select $timeSeries t, Attributes['hostname'] as Host,  max(Value) as DiskFreeBytes from $table
                    where ServiceName = 'as1-clickhouse'
                    AND $timeFilter
                    AND MetricName = 'chi_clickhouse_metric_DiskFreeBytes'
                    AND Attributes['hostname'] in ('chi-clickhouse-ch-01-0-0.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-1.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-2.clickhouse.svc.cluster.local')
                    group by t, Host ORDER BY t, Host

                rawQuery: |-
                    /* grafana dashboard=$__dashboard, user='4' */
                    select (intDiv(toFloat64(TimeUnix) * 1000, (30 * 1000)) * (30 * 1000)) t, Attributes['hostname'] as Host,  max(Value) as DiskFreeBytes from base14.otel_metrics_gauge
                    where ServiceName = 'as1-clickhouse'
                    AND TimeUnix >= toDateTime64(1754207879,3) AND TimeUnix <= toDateTime64(1754229479,3)
                    AND MetricName = 'chi_clickhouse_metric_DiskFreeBytes'
                    AND Attributes['hostname'] in ('chi-clickhouse-ch-01-0-0.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-1.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-2.clickhouse.svc.cluster.local')
                    group by t, Host ORDER BY t, Host
                refId: A
                round: 0s
                showFormattedSQL: true
                skip_comments: true
                table: otel_metrics_gauge
                useWindowFuncForMacros: true
              refId: A
              relativeTimeRange:
                from: 600
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: A
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: B
                type: reduce
              refId: B
              relativeTimeRange: {}
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 1e+12
                        type: lt
                      operator:
                        type: and
                      query:
                        params:
                            - C
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: B
                intervalMs: 1000
                maxDataPoints: 43200
                refId: C
                type: threshold
              refId: C
              relativeTimeRange: {}
          execErrState: Error
          folderUID: eesmjo9rimnswf
          for: 1m0s
          id: 3
          noDataState: NoData
          notification_settings:
            group_by: null
            mute_time_intervals: null
            receiver: base14-oncall
          orgID: 1
          ruleGroup: Per Minute Eval
          title: Free Disk below 100 GB on as1-clickhouse
          uid: eesx33m3mkyyod
          updated: "2025-08-03T16:34:42.000Z"
        - annotations:
            __dashboardUid__: deqjlf2k6d81sa
            __panelId__: "5"
            description: Total Restarts on as1-apps > 5
            summary: Total Restarts on as1-apps > 5
          condition: C
          data:
            - datasourceUid: ds-scout-altinity-ch
              model:
                adHocFilters: []
                adHocValuesQuery: ""
                add_metadata: true
                contextWindowSize: "10"
                database: base14
                datasource:
                    type: vertamedia-clickhouse-datasource
                    uid: ds-scout-altinity-ch
                dateTimeColDataType: TimeUnix
                dateTimeType: DATETIME64
                editorMode: sql
                extrapolate: true
                format: time_series
                formattedQuery: SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t
                interval: ""
                intervalFactor: 1
                intervalMs: 1000
                maxDataPoints: 43200
                nullifySparse: false
                query: |
                    $increase(Value)
                    FROM $table
                    WHERE $timeFilter
                    AND MetricName = 'k8s.container.restarts'
                    AND ServiceName = 'scout-as1-apps-gke'
                rawQuery: |-
                    /* grafana dashboard=$__dashboard, user='4' */
                    SELECT t, if((max_0 - lagInFrame(max_0,1,0) OVER ()) < 0, 0, max_0 - lagInFrame(max_0,1,0) OVER ()) AS max_0_Increase FROM ( SELECT (intDiv(toFloat64(TimeUnix) * 1000, (5 * 1000)) * (5 * 1000)) AS t, max(Value) AS max_0 FROM base14.otel_metrics_gauge
                    WHERE TimeUnix >= toDateTime64(1753374598,3) AND TimeUnix <= toDateTime64(1753378198,3) AND TimeUnix >= toDateTime64(1753374598,3) AND TimeUnix <= toDateTime64(1753378198,3)
                    AND MetricName = 'k8s.container.restarts'
                    AND ServiceName = 'scout-as1-apps-gke' GROUP BY t ORDER BY t)
                refId: A
                round: 0s
                skip_comments: true
                table: otel_metrics_gauge
                useWindowFuncForMacros: true
              refId: A
              relativeTimeRange:
                from: 600
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: A
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: B
                type: reduce
              refId: B
              relativeTimeRange: {}
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 5
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - C
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: B
                intervalMs: 1000
                maxDataPoints: 43200
                refId: C
                type: threshold
              refId: C
              relativeTimeRange: {}
          execErrState: Error
          folderUID: eesmjo9rimnswf
          for: 1m0s
          id: 4
          noDataState: NoData
          notification_settings:
            group_by: null
            mute_time_intervals: null
            receiver: base14-oncall
          orgID: 1
          ruleGroup: Per Minute Eval
          title: Total Restarts on as1-apps
          uid: besx3b10rz56of
          updated: "2025-08-03T16:34:42.000Z"
        - annotations:
            __dashboardUid__: dermo1ksrv6yob
            __panelId__: "5"
            description: "Free Disk below 100 GB on euw1-clickhouse Node {{ $labels.Host }} \n\n{{ index $values \"B\" }}  - Used Disk for {{ index $labels.Host }} over the last 5 minutes."
            summary: Free Disk below 100 GB on euw1-clickhouse  {{ $labels.Host }}
          condition: C
          data:
            - datasourceUid: ds-scout-altinity-ch
              model:
                adHocFilters: []
                adHocValuesQuery: ""
                add_metadata: true
                contextWindowSize: "10"
                database: base14
                datasource:
                    type: vertamedia-clickhouse-datasource
                    uid: ds-scout-altinity-ch
                dateTimeColDataType: TimeUnix
                dateTimeType: DATETIME64
                editorMode: sql
                extrapolate: true
                format: time_series
                formattedQuery: SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t
                interval: ""
                intervalFactor: 1
                intervalMs: 1000
                maxDataPoints: 43200
                nullifySparse: false
                query: |+
                    select $timeSeries t, Attributes['hostname'] as Host,  max(Value) as DiskFreeBytes from $table
                    where ServiceName = 'euw1-clickhouse'
                    AND $timeFilter
                    AND MetricName = 'chi_clickhouse_metric_DiskFreeBytes'
                    AND Attributes['hostname'] in ('chi-clickhouse-ch-01-0-0.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-1.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-2.clickhouse.svc.cluster.local')
                    group by t, Host order by t, Host

                rawQuery: |-
                    /* grafana dashboard=$__dashboard, user='4' */
                    select (intDiv(toFloat64(TimeUnix) * 1000, (120 * 1000)) * (120 * 1000)) t, Attributes['hostname'] as Host,  max(Value) as DiskFreeBytes from base14.otel_metrics_gauge
                    where ServiceName = 'euw1-clickhouse'
                    AND TimeUnix >= toDateTime64(1754149550,3) AND TimeUnix <= toDateTime64(1754235950,3)
                    AND MetricName = 'chi_clickhouse_metric_DiskFreeBytes'
                    AND Attributes['hostname'] in ('chi-clickhouse-ch-01-0-0.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-1.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-2.clickhouse.svc.cluster.local')
                    group by t, Host order by t, Host
                refId: A
                round: 0s
                showFormattedSQL: false
                skip_comments: true
                table: otel_metrics_gauge
                useWindowFuncForMacros: true
              refId: A
              relativeTimeRange:
                from: 600
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: A
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: B
                type: reduce
              refId: B
              relativeTimeRange: {}
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 1.073741824e+11
                        type: lt
                      operator:
                        type: and
                      query:
                        params:
                            - C
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: B
                intervalMs: 1000
                maxDataPoints: 43200
                refId: C
                type: threshold
              refId: C
              relativeTimeRange: {}
          execErrState: Error
          folderUID: eesmjo9rimnswf
          for: 1m0s
          id: 5
          noDataState: NoData
          notification_settings:
            group_by: null
            mute_time_intervals: null
            receiver: base14-oncall
          orgID: 1
          ruleGroup: Per Minute Eval
          title: Free Disk below 100 GB on euw1-clickhouse
          uid: detux3aitircwd
          updated: "2025-08-03T16:34:42.000Z"
        - annotations:
            __dashboardUid__: dermo1ksrv6yob
            __panelId__: "5"
            description: "Free Disk below 100 GB on use1-clickhouse Node {{ $labels.Host }} \n\n{{ index $values \"B\" }}  - Used Disk for {{ index $labels.Host }} over the last 5 minutes."
            summary: Free Disk below 100 GB on use1-clickhouse Node  {{ $labels.Host }}
          condition: C
          data:
            - datasourceUid: ds-scout-altinity-ch
              model:
                adHocFilters: []
                adHocValuesQuery: ""
                add_metadata: true
                contextWindowSize: "10"
                database: base14
                datasource:
                    type: vertamedia-clickhouse-datasource
                    uid: ds-scout-altinity-ch
                dateTimeColDataType: TimeUnix
                dateTimeType: DATETIME64
                editorMode: sql
                extrapolate: true
                format: time_series
                formattedQuery: SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t
                interval: ""
                intervalFactor: 1
                intervalMs: 1000
                maxDataPoints: 43200
                nullifySparse: false
                query: |+
                    select $timeSeries t, Attributes['hostname'] as Host,  max(Value) as DiskFreeBytes from $table
                    where ServiceName = 'use1-clickhouse'
                    AND $timeFilter
                    AND MetricName = 'chi_clickhouse_metric_DiskFreeBytes'
                    AND Attributes['hostname'] in ('chi-clickhouse-ch-01-0-0.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-1.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-2.clickhouse.svc.cluster.local')
                    group by t, Host ORDER BY t, Host

                rawQuery: |-
                    /* grafana dashboard=$__dashboard, user='4' */
                    select (intDiv(toFloat64(TimeUnix) * 1000, (120 * 1000)) * (120 * 1000)) t, Attributes['hostname'] as Host,  max(Value) as DiskFreeBytes from base14.otel_metrics_gauge
                    where ServiceName = 'use1-clickhouse'
                    AND TimeUnix >= toDateTime64(1754149550,3) AND TimeUnix <= toDateTime64(1754235950,3)
                    AND MetricName = 'chi_clickhouse_metric_DiskFreeBytes'
                    AND Attributes['hostname'] in ('chi-clickhouse-ch-01-0-0.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-1.clickhouse.svc.cluster.local','chi-clickhouse-ch-01-0-2.clickhouse.svc.cluster.local')
                    group by t, Host ORDER BY t, Host
                refId: A
                round: 0s
                showFormattedSQL: true
                skip_comments: true
                table: otel_metrics_gauge
                useWindowFuncForMacros: true
              refId: A
              relativeTimeRange:
                from: 600
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: A
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: B
                type: reduce
              refId: B
              relativeTimeRange: {}
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 1.073741824e+11
                        type: lt
                      operator:
                        type: and
                      query:
                        params:
                            - C
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: B
                intervalMs: 1000
                maxDataPoints: 43200
                refId: C
                type: threshold
              refId: C
              relativeTimeRange: {}
          execErrState: Error
          folderUID: eesmjo9rimnswf
          for: 1m0s
          id: 6
          noDataState: NoData
          notification_settings:
            group_by: null
            mute_time_intervals: null
            receiver: base14-oncall
          orgID: 1
          ruleGroup: Per Minute Eval
          title: Free Disk below 100 GB on  use1-clickhouse
          uid: fetux5lxogfswd
          updated: "2025-08-03T16:34:42.000Z"
        - annotations:
            __dashboardUid__: fdef46f5-f98f-46bb-b2c2-92bf02cd07ee
            __panelId__: "1"
            description: |-
                USE1 Node {{ $labels.node }} CPU Utilization above 80%

                {{ index $values "B" }} CPU usage for {{ index $labels.node }} over the last 5 minutes.
            summary: USE1 Node {{ $labels.node }} CPU Utilization above 80%
          condition: C
          data:
            - datasourceUid: ds-scout-altinity-ch
              model:
                adHocFilters: []
                adHocValuesQuery: ""
                add_metadata: true
                contextWindowSize: "10"
                database: base14
                datasource:
                    type: vertamedia-clickhouse-datasource
                    uid: ds-scout-altinity-ch
                dateTimeColDataType: TimeUnix
                dateTimeType: DATETIME64
                editorMode: sql
                extrapolate: true
                format: time_series
                formattedQuery: SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t
                instant: false
                interval: ""
                intervalFactor: 1
                intervalMs: 10000
                maxDataPoints: 43200
                nullifySparse: false
                query: "--$columns(ResourceAttributes['k8s.node.name'] node, avg(Value) as cpu_utilization)\nselect $timeSeries t, ResourceAttributes['k8s.node.name'] as node, max(Value) \nfrom $table \nwhere $timeFilter\nand MetricName = 'k8s.node.cpu.utilization'\nand ServiceName = 'scout-use1-apps-eks'\nGroup by t, node\nOrder by t, node\n"
                range: true
                rawQuery: "/* grafana dashboard=$__dashboard, user='4' */\n\nselect (intDiv(toFloat64(TimeUnix) * 1000, (30 * 1000)) * (30 * 1000)) t, ResourceAttributes['k8s.node.name'] as node, max(Value) \nfrom base14.otel_metrics_gauge \nwhere TimeUnix >= toDateTime64(1754205560,3) AND TimeUnix <= toDateTime64(1754227160,3)\nand MetricName = 'k8s.node.cpu.utilization'\nand ServiceName = 'scout-use1-apps-eks'\nGroup by t, node\nOrder by t, node"
                refId: A
                round: 0s
                showFormattedSQL: false
                skip_comments: true
                table: otel_metrics_gauge
                useWindowFuncForMacros: true
              refId: A
              relativeTimeRange:
                from: 300
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: A
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: B
                settings:
                    mode: ""
                type: reduce
              refId: B
              relativeTimeRange: {}
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 0.8
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - C
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: B
                intervalMs: 1000
                maxDataPoints: 43200
                refId: C
                type: threshold
              refId: C
              relativeTimeRange: {}
          execErrState: Error
          folderUID: eesmjo9rimnswf
          for: 1m0s
          id: 7
          noDataState: NoData
          notification_settings:
            group_by: null
            mute_time_intervals: null
            receiver: base14-oncall
          orgID: 1
          ruleGroup: Per Minute Eval
          title: USE1 Node CPU Utilization above 80%
          uid: aetw5vvvlyrcwf
          updated: "2025-08-03T16:34:42.000Z"
        - annotations:
            __dashboardUid__: fdef46f5-f98f-46bb-b2c2-92bf02cd07ee
            __panelId__: "1"
            description: |-
                APS1 Node {{ $labels.node }} CPU Utilization above 80%

                {{ index $values "B" }} CPU usage for {{ index $labels.node }} over the last 5 minutes.
            summary: APS1 Node {{ $labels.node }} CPU Utilization above 80%
          condition: C
          data:
            - datasourceUid: ds-scout-altinity-ch
              model:
                adHocFilters: []
                adHocValuesQuery: ""
                add_metadata: true
                contextWindowSize: "10"
                database: base14
                datasource:
                    type: vertamedia-clickhouse-datasource
                    uid: ds-scout-altinity-ch
                dateTimeColDataType: TimeUnix
                dateTimeType: DATETIME64
                editorMode: sql
                extrapolate: true
                format: time_series
                formattedQuery: SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t
                instant: false
                interval: ""
                intervalFactor: 1
                intervalMs: 10000
                maxDataPoints: 43200
                nullifySparse: false
                query: "--$columns(ResourceAttributes['k8s.node.name'] node, avg(Value) as cpu_utilization)\nselect $timeSeries t, ResourceAttributes['k8s.node.name'] as node, max(Value) \nfrom $table \nwhere $timeFilter\nand MetricName = 'k8s.node.cpu.utilization'\nand ServiceName = 'scout-aps1-apps-eks'\nGroup by t, node\nOrder by t, node\n"
                range: true
                rawQuery: "/* grafana dashboard=$__dashboard, user='4' */\n\nselect (intDiv(toFloat64(TimeUnix) * 1000, (30 * 1000)) * (30 * 1000)) t, ResourceAttributes['k8s.node.name'] as node, max(Value) \nfrom base14.otel_metrics_gauge \nwhere TimeUnix >= toDateTime64(1754205560,3) AND TimeUnix <= toDateTime64(1754227160,3)\nand MetricName = 'k8s.node.cpu.utilization'\nand ServiceName = 'scout-aps1-apps-eks'\nGroup by t, node\nOrder by t, node"
                refId: A
                round: 0s
                showFormattedSQL: false
                skip_comments: true
                table: otel_metrics_gauge
                useWindowFuncForMacros: true
              refId: A
              relativeTimeRange:
                from: 300
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: A
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: B
                settings:
                    mode: ""
                type: reduce
              refId: B
              relativeTimeRange: {}
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 0.8
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - C
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: B
                intervalMs: 1000
                maxDataPoints: 43200
                refId: C
                type: threshold
              refId: C
              relativeTimeRange: {}
          execErrState: Error
          folderUID: eesmjo9rimnswf
          for: 1m0s
          id: 8
          noDataState: NoData
          notification_settings:
            group_by: null
            mute_time_intervals: null
            receiver: base14-oncall
          orgID: 1
          ruleGroup: Per Minute Eval
          title: APS1 Node CPU Utilization above 80% (copy)
          uid: detw8h7rbopvka
          updated: "2025-08-03T16:34:42.000Z"
        - annotations:
            __dashboardUid__: fdef46f5-f98f-46bb-b2c2-92bf02cd07ee
            __panelId__: "1"
            description: |-
                AS1 Node {{ $labels.node }} CPU Utilization above 80%

                {{ index $values "B" }} CPU usage for {{ index $labels.node }} over the last 5 minutes.
            summary: AS1 Node {{ $labels.node }} CPU Utilization above 80%
          condition: C
          data:
            - datasourceUid: ds-scout-altinity-ch
              model:
                adHocFilters: []
                adHocValuesQuery: ""
                add_metadata: true
                contextWindowSize: "10"
                database: base14
                datasource:
                    type: vertamedia-clickhouse-datasource
                    uid: ds-scout-altinity-ch
                dateTimeColDataType: TimeUnix
                dateTimeType: DATETIME64
                editorMode: sql
                extrapolate: true
                format: time_series
                formattedQuery: SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t
                instant: false
                interval: ""
                intervalFactor: 1
                intervalMs: 10000
                maxDataPoints: 43200
                nullifySparse: false
                query: "--$columns(ResourceAttributes['k8s.node.name'] node, avg(Value) as cpu_utilization)\nselect $timeSeries t, ResourceAttributes['k8s.node.name'] as node, max(Value) \nfrom $table \nwhere $timeFilter\nand MetricName = 'k8s.node.cpu.utilization'\nand ServiceName = 'scout-as1-apps-gke'\nGroup by t, node\nOrder by t, node\n"
                range: true
                rawQuery: "/* grafana dashboard=$__dashboard, user='4' */\n\nselect (intDiv(toFloat64(TimeUnix) * 1000, (30 * 1000)) * (30 * 1000)) t, ResourceAttributes['k8s.node.name'] as node, max(Value) \nfrom base14.otel_metrics_gauge \nwhere TimeUnix >= toDateTime64(1754205560,3) AND TimeUnix <= toDateTime64(1754227160,3)\nand MetricName = 'k8s.node.cpu.utilization'\nand ServiceName = 'scout-as1-apps-gke'\nGroup by t, node\nOrder by t, node"
                refId: A
                round: 0s
                showFormattedSQL: false
                skip_comments: true
                table: otel_metrics_gauge
                useWindowFuncForMacros: true
              refId: A
              relativeTimeRange:
                from: 300
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: A
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: B
                settings:
                    mode: ""
                type: reduce
              refId: B
              relativeTimeRange: {}
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 0.8
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - C
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: B
                intervalMs: 1000
                maxDataPoints: 43200
                refId: C
                type: threshold
              refId: C
              relativeTimeRange: {}
          execErrState: Error
          folderUID: eesmjo9rimnswf
          for: 1m0s
          id: 9
          noDataState: NoData
          notification_settings:
            group_by: null
            mute_time_intervals: null
            receiver: base14-oncall
          orgID: 1
          ruleGroup: Per Minute Eval
          title: AS1 Node CPU Utilization above 80% (copy 2)
          uid: cetw8pds6f2f4f
          updated: "2025-08-03T16:34:42.000Z"
        - annotations:
            __dashboardUid__: fdef46f5-f98f-46bb-b2c2-92bf02cd07ee
            __panelId__: "1"
            description: |-
                EUW1 Node {{ $labels.node }} CPU Utilization above 80%

                {{ index $values "B" }} CPU usage for {{ index $labels.node }} over the last 5 minutes.
            summary: EUW1 Node {{ $labels.node }} CPU Utilization above 80%
          condition: C
          data:
            - datasourceUid: ds-scout-altinity-ch
              model:
                adHocFilters: []
                adHocValuesQuery: ""
                add_metadata: true
                contextWindowSize: "10"
                database: base14
                datasource:
                    type: vertamedia-clickhouse-datasource
                    uid: ds-scout-altinity-ch
                dateTimeColDataType: TimeUnix
                dateTimeType: DATETIME64
                editorMode: sql
                extrapolate: true
                format: time_series
                formattedQuery: SELECT $timeSeries as t, count() FROM $table WHERE $timeFilter GROUP BY t ORDER BY t
                instant: false
                interval: ""
                intervalFactor: 1
                intervalMs: 10000
                maxDataPoints: 43200
                nullifySparse: false
                query: "--$columns(ResourceAttributes['k8s.node.name'] node, avg(Value) as cpu_utilization)\nselect $timeSeries t, ResourceAttributes['k8s.node.name'] as node, max(Value) \nfrom $table \nwhere $timeFilter\nand MetricName = 'k8s.node.cpu.utilization'\nand ServiceName = 'scout-euw1-apps-eks'\nGroup by t, node\nOrder by t, node\n"
                range: true
                rawQuery: "/* grafana dashboard=$__dashboard, user='4' */\n\nselect (intDiv(toFloat64(TimeUnix) * 1000, (30 * 1000)) * (30 * 1000)) t, ResourceAttributes['k8s.node.name'] as node, max(Value) \nfrom base14.otel_metrics_gauge \nwhere TimeUnix >= toDateTime64(1754205560,3) AND TimeUnix <= toDateTime64(1754227160,3)\nand MetricName = 'k8s.node.cpu.utilization'\nand ServiceName = 'scout-euw1-apps-eks'\nGroup by t, node\nOrder by t, node"
                refId: A
                round: 0s
                showFormattedSQL: false
                skip_comments: true
                table: otel_metrics_gauge
                useWindowFuncForMacros: true
              refId: A
              relativeTimeRange:
                from: 300
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: A
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: B
                settings:
                    mode: ""
                type: reduce
              refId: B
              relativeTimeRange: {}
            - datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 0.8
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - C
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: B
                intervalMs: 1000
                maxDataPoints: 43200
                refId: C
                type: threshold
              refId: C
              relativeTimeRange: {}
          execErrState: Error
          folderUID: eesmjo9rimnswf
          for: 1m0s
          id: 10
          noDataState: NoData
          notification_settings:
            group_by: null
            mute_time_intervals: null
            receiver: base14-oncall
          orgID: 1
          ruleGroup: Per Minute Eval
          title: EUW1 Node CPU Utilization above 80% (copy)
          uid: aetw8s9772vpca
          updated: "2025-08-03T16:34:42.000Z"
    title: Per Minute Eval
